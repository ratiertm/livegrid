# PDCA Plan - Grid Configuration v2 (3-Layer Architecture)

## Context

**User Request:** Grid ì„¤ì • ì‹œìŠ¤í…œì„ 3ê°œ ë ˆì´ì–´ë¡œ ë¶„ë¦¬í•˜ì—¬ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬

**í˜„ì¬ ë¬¸ì œ:**
- Grid ì •ì˜(columns, data_source)ê°€ ì½”ë“œì— í•˜ë“œì½”ë”© â†’ ëŸ°íƒ€ì„ì—ì„œ "ì›ë³¸"ì„ ì•Œ ìˆ˜ ì—†ìŒ
- ìˆ¨ê¸´ ì»¬ëŸ¼ ë³µì› ì‹œ ì›ë³¸ ì •ë³´ê°€ ì—†ì–´ `grid.state[:all_columns]`ì— ì„ì‹œ ì €ì¥í•˜ëŠ” ìš°íšŒ í•„ìš”
- Config Modalì´ ë³€ê²½ë§Œ ì²˜ë¦¬í•˜ê³ , "ì–´ë–¤ ê·¸ë¦¬ë“œì¸ì§€" ì •ì˜í•˜ëŠ” ë ˆì´ì–´ê°€ ì—†ìŒ
- ë³€ê²½ì‚¬í•­ ì ìš© ì „ ë¯¸ë¦¬ë³´ê¸° ë¶ˆê°€ â†’ ì˜ëª» ì ìš© ì‹œ ë˜ëŒë¦¬ê¸° ì–´ë ¤ì›€

**í˜„ì¬ êµ¬í˜„ ìƒíƒœ (grid-config Phase 1+2):**
- Config Modal 4íƒ­: Column Visibility, Column Properties, Formatters, Grid Settings
- Apply ì‹œ ê·¸ë¦¬ë“œ ë™ì  ë°˜ì˜ ë™ì‘ í™•ì¸ ì™„ë£Œ
- ìˆ¨ê¸´ ì»¬ëŸ¼ ë³µì› ë²„ê·¸ ìˆ˜ì • (state[:all_columns] ìš°íšŒ)

---

## 3-Layer Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: Grid Definition (Blueprint)                â”‚
â”‚  "ì´ ê·¸ë¦¬ë“œëŠ” ë¬´ì—‡ì¸ê°€?" - ì›ë³¸ ì •ì˜ (ë¶ˆë³€)           â”‚
â”‚  â†’ GridDefinition struct                             â”‚
â”‚  â†’ columns ì›ë³¸, data_source, default options        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2: Runtime Config (í˜„ì¬ Config Modal)          â”‚
â”‚  "ì´ ê·¸ë¦¬ë“œë¥¼ ì–´ë–»ê²Œ ë³´ì—¬ì¤„ê¹Œ?" - ì‚¬ìš©ì ì»¤ìŠ¤í„°ë§ˆì´ì§•   â”‚
â”‚  â†’ ì»¬ëŸ¼ ìˆ¨ê¸°ê¸°/ìˆœì„œ/ì†ì„±/í¬ë§·í„°/í…Œë§ˆ ë“±              â”‚
â”‚  â†’ Blueprint ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½, í•­ìƒ ì›ë³¸ ì°¸ì¡° ê°€ëŠ¥        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3: Preview & Apply                            â”‚
â”‚  "ë³€ê²½ì‚¬í•­ì„ í™•ì¸í•˜ê³  ì ìš©" - ë¯¸ë¦¬ë³´ê¸° + ë°˜ì˜          â”‚
â”‚  â†’ ë³€ê²½ ì „/í›„ ë¹„êµ (Diff)                            â”‚
â”‚  â†’ ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ â†’ Apply/Revert                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: Grid Definition (Blueprint)

### ëª©í‘œ
Gridì˜ "ì›ë³¸ ì •ì˜"ë¥¼ ë³„ë„ êµ¬ì¡°ì²´ë¡œ ê´€ë¦¬í•˜ì—¬, Runtime Configê°€ í•­ìƒ ì›ë³¸ì„ ì°¸ì¡°í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

### GridDefinition Struct

```elixir
defmodule LiveViewGrid.GridDefinition do
  @type t :: %__MODULE__{
    id: String.t(),
    label: String.t(),
    description: String.t(),
    columns: [column_def()],
    data_source: data_source_config(),
    default_options: map()
  }

  @type column_def :: %{
    field: atom(),
    label: String.t(),
    type: :string | :integer | :float | :boolean | :date | :datetime,
    width: integer() | :auto,
    align: :left | :center | :right,
    sortable: boolean(),
    filterable: boolean(),
    editable: boolean(),
    editor_type: atom(),
    editor_options: list(),
    formatter: atom() | nil,
    formatter_options: map(),
    validators: list(),
    renderer: atom() | nil,
    header_group: String.t() | nil,
    required: boolean()
  }

  @type data_source_config ::
    {:inmemory, list(map())}
    | {:ecto, %{repo: module(), schema: module(), base_query: term()}}
    | {:rest, %{base_url: String.t(), endpoint: String.t(), headers: map()}}
end
```

### í•µì‹¬ ë³€ê²½: Grid.newì— definition ë³´ì¡´

```elixir
# í˜„ì¬
Grid.new(data: [...], columns: [...], options: %{...})
# â†’ grid.columnsì— ì •ê·œí™”ëœ ì»¬ëŸ¼ë§Œ ì¡´ì¬, ì›ë³¸ ì—†ìŒ

# ë³€ê²½ í›„
Grid.new(definition: grid_def)
# ë˜ëŠ”
Grid.new(data: [...], columns: [...], options: %{...})
# â†’ grid.definitionì— ì›ë³¸ ì •ì˜ ë³´ì¡´
# â†’ grid.columnsëŠ” definition + runtime config ì ìš© ê²°ê³¼
```

### ë‹¬ë¼ì§€ëŠ” ì 

| í˜„ì¬ | ë³€ê²½ í›„ |
|------|---------|
| ìˆ¨ê¸´ ì»¬ëŸ¼ â†’ `state[:all_columns]`ì— ì„ì‹œ ì €ì¥ | `definition.columns`ê°€ í•­ìƒ ì›ë³¸ |
| Config Modalì´ `grid.columns`ì—ì„œ ì´ˆê¸°í™” | `grid.definition.columns`ì—ì„œ ì´ˆê¸°í™” |
| Reset ë²„íŠ¼ â†’ ì–´ë””ë¡œ ëŒì•„ê°€ì•¼ í•˜ëŠ”ì§€ ëª¨í˜¸ | `definition`ìœ¼ë¡œ ì™„ì „ ë³µì› |
| Data source ë³€ê²½ ë¶ˆê°€ | `definition.data_source` ìˆ˜ì • í›„ ì¬ìƒì„± |

### íŒŒì¼ êµ¬ì¡°

```
lib/liveview_grid/
  â”œâ”€â”€ grid_definition.ex          # NEW: GridDefinition struct + ê²€ì¦
  â”œâ”€â”€ grid.ex                     # MODIFY: definition í•„ë“œ ì¶”ê°€, ì›ë³¸ ì°¸ì¡°
  â””â”€â”€ grid_builder.ex             # NEW: definition â†’ grid ë¹Œë“œ í•¨ìˆ˜
```

### êµ¬í˜„ ìˆœì„œ

1. `GridDefinition` struct ì •ì˜ + ê²€ì¦ í•¨ìˆ˜
2. `Grid` structì— `definition` í•„ë“œ ì¶”ê°€
3. `Grid.new/1`ì—ì„œ definition ë³´ì¡´ ë¡œì§ ì¶”ê°€
4. `apply_config_changes`ì—ì„œ `state[:all_columns]` ëŒ€ì‹  `definition.columns` ì‚¬ìš©
5. Config Modal `init_column_state`ì—ì„œ `definition.columns` ì°¸ì¡°
6. ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

### ì„±ê³µ ê¸°ì¤€

- [ ] `Grid.new`ë¡œ ìƒì„±ëœ gridì— `definition` í•„ë“œ ì¡´ì¬
- [ ] `definition.columns`ì— ëª¨ë“  ì›ë³¸ ì»¬ëŸ¼ ì •ë³´ ë³´ì¡´
- [ ] ì»¬ëŸ¼ ìˆ¨ê¸°ê¸°/ë³´ì´ê¸° ì‹œ `definition.columns` ê¸°ë°˜ ë³µì›
- [ ] Reset ì‹œ `definition`ìœ¼ë¡œ ì™„ì „ ë³µì›
- [ ] ê¸°ì¡´ `Grid.new(data:, columns:, options:)` í˜¸í™˜ì„± ìœ ì§€

---

## Phase 2: Definition Editor UI (Grid Setup Config)

### ëª©í‘œ
Grid Definitionì„ UIì—ì„œ ìƒì„±/í¸ì§‘í•  ìˆ˜ ìˆëŠ” ì—ë””í„° ì œê³µ

### UI êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Grid Definition Editor                     âœ•    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ê¸°ë³¸ ì •ë³´] [ì»¬ëŸ¼ ì •ì˜] [ë°ì´í„° ì†ŒìŠ¤]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Tab 1: ê¸°ë³¸ ì •ë³´                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Grid ID:    [user-grid          ]          â”‚  â”‚
â”‚  â”‚ Label:      [ì‚¬ìš©ì ê´€ë¦¬ ê·¸ë¦¬ë“œ    ]         â”‚  â”‚
â”‚  â”‚ Description: [ì‚¬ìš©ì CRUD ê·¸ë¦¬ë“œ  ]         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â”‚  Tab 2: ì»¬ëŸ¼ ì •ì˜                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [+ ì»¬ëŸ¼ ì¶”ê°€]                     [JSON]   â”‚  â”‚
â”‚  â”‚                                            â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â”‚# â”‚ field â”‚ label â”‚ type â”‚widthâ”‚ options â”‚  â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚ â”‚1 â”‚ id   â”‚ ID    â”‚ int â”‚ 80 â”‚ sort,RO â”‚  â”‚  â”‚
â”‚  â”‚ â”‚2 â”‚ name â”‚ ì´ë¦„  â”‚ str â”‚150 â”‚ sort,ed â”‚  â”‚  â”‚
â”‚  â”‚ â”‚3 â”‚ emailâ”‚ ì´ë©”ì¼â”‚ str â”‚200 â”‚ sort,ed â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â”‚  Tab 3: ë°ì´í„° ì†ŒìŠ¤                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Type: (â—) InMemory  ( ) Ecto  ( ) REST    â”‚  â”‚
â”‚  â”‚                                            â”‚  â”‚
â”‚  â”‚ [InMemory ì„ íƒ ì‹œ]                         â”‚  â”‚
â”‚  â”‚ ì´ˆê¸° ë°ì´í„°: JSON ë˜ëŠ” ìƒ˜í”Œ ìë™ ìƒì„±       â”‚  â”‚
â”‚  â”‚                                            â”‚  â”‚
â”‚  â”‚ [Ecto ì„ íƒ ì‹œ]                             â”‚  â”‚
â”‚  â”‚ Repo:    [MyApp.Repo      ]               â”‚  â”‚
â”‚  â”‚ Schema:  [MyApp.User      ]               â”‚  â”‚
â”‚  â”‚ [Test Connection]                          â”‚  â”‚
â”‚  â”‚                                            â”‚  â”‚
â”‚  â”‚ [REST ì„ íƒ ì‹œ]                             â”‚  â”‚
â”‚  â”‚ Base URL: [https://api.example.com]       â”‚  â”‚
â”‚  â”‚ Endpoint: [/users                 ]       â”‚  â”‚
â”‚  â”‚ Headers:  [Authorization: Bearer...]      â”‚  â”‚
â”‚  â”‚ [Test Connection]                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [Cancel] [Save Definition] [Preview] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### íŒŒì¼ êµ¬ì¡°

```
lib/liveview_grid_web/components/grid_config/
  â”œâ”€â”€ config_modal.ex             # ê¸°ì¡´: Runtime Config Modal
  â”œâ”€â”€ definition_editor.ex        # NEW: Definition Editor LiveComponent
  â””â”€â”€ tabs/
      â”œâ”€â”€ def_basic_tab.ex        # NEW: ê¸°ë³¸ ì •ë³´ íƒ­
      â”œâ”€â”€ def_columns_tab.ex      # NEW: ì»¬ëŸ¼ ì •ì˜ íƒ­
      â””â”€â”€ def_datasource_tab.ex   # NEW: ë°ì´í„° ì†ŒìŠ¤ íƒ­
```

### ì„±ê³µ ê¸°ì¤€

- [ ] UIì—ì„œ Grid Definition ìƒì„± ê°€ëŠ¥
- [ ] ì»¬ëŸ¼ ì¶”ê°€/ì‚­ì œ/í¸ì§‘ ê°€ëŠ¥
- [ ] Data Source íƒ€ì… ì„ íƒ ë° ì„¤ì • ê°€ëŠ¥
- [ ] JSON import/export ì§€ì›
- [ ] Save Definition â†’ Grid ìë™ ìƒì„±/ê°±ì‹ 

---

## Phase 3: Preview & Apply

### ëª©í‘œ
Config ë³€ê²½ì‚¬í•­ì„ ì ìš©í•˜ê¸° ì „ì— ë¯¸ë¦¬ë³´ê¸°ë¡œ í™•ì¸í•˜ê³ , í™•ì¸ í›„ ë°˜ì˜

### UI êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Grid Configuration                         âœ•    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Visibility] [Properties] [Formatters] [Settings] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  [ì„¤ì • ì˜ì—­ - í˜„ì¬ì™€ ë™ì¼]                        â”‚
â”‚                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ ë³€ê²½ì‚¬í•­ ìš”ì•½ (3ê±´)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ name ì»¬ëŸ¼: label "ì´ë¦„" â†’ "ì„±ëª…"         â”‚  â”‚
â”‚  â”‚ â€¢ name ì»¬ëŸ¼: width 150 â†’ 200              â”‚  â”‚
â”‚  â”‚ â€¢ theme: "light" â†’ "dark"                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â”‚  [Preview Grid â–¼]                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  (ì¶•ì†Œëœ ê·¸ë¦¬ë“œ ë¯¸ë¦¬ë³´ê¸° - ë³€ê²½ì‚¬í•­ ì ìš©)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          [Reset] [Cancel] [Preview] [Apply]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ê¸°ëŠ¥

1. **ë³€ê²½ì‚¬í•­ Diff**: í˜„ì¬ ì„¤ì • vs ë³€ê²½ëœ ì„¤ì • ë¹„êµ í‘œì‹œ
2. **ë¯¸ë‹ˆ í”„ë¦¬ë·°**: ëª¨ë‹¬ í•˜ë‹¨ì— ì¶•ì†Œëœ ê·¸ë¦¬ë“œë¡œ ë³€ê²½ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
3. **Apply í™•ì¸**: ë³€ê²½ì‚¬í•­ ê°œìˆ˜ì™€ ì˜í–¥ ë²”ìœ„ í‘œì‹œ í›„ í™•ì¸
4. **Undo í†µí•©**: Apply í›„ Ctrl+Zë¡œ ì´ì „ ìƒíƒœ ë³µì› ê°€ëŠ¥

### êµ¬í˜„ ë°©ì‹

```elixir
# Config Modalì— ë³€ê²½ì‚¬í•­ ì¶”ì  ì¶”ê°€
defp compute_changes(original_configs, current_configs, original_options, current_options) do
  column_changes = diff_column_configs(original_configs, current_configs)
  option_changes = diff_options(original_options, current_options)
  %{columns: column_changes, options: option_changes, count: length(column_changes) + length(option_changes)}
end
```

### ì„±ê³µ ê¸°ì¤€

- [ ] ë³€ê²½ì‚¬í•­ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìš”ì•½ í‘œì‹œ
- [ ] Preview í´ë¦­ ì‹œ ì¶•ì†Œ ê·¸ë¦¬ë“œì— ë³€ê²½ ë°˜ì˜
- [ ] Apply ì „ ë³€ê²½ì‚¬í•­ ìˆ˜ í‘œì‹œ
- [ ] ë³€ê²½ ì—†ìœ¼ë©´ Apply ë²„íŠ¼ ë¹„í™œì„±í™”
- [ ] Reset ì‹œ definition ì›ë³¸ìœ¼ë¡œ ë³µì›

---

## êµ¬í˜„ ìš°ì„ ìˆœìœ„

| ìˆœì„œ | Phase | í•µì‹¬ ê°€ì¹˜ | ì˜ˆìƒ ê¸°ê°„ |
|------|-------|----------|----------|
| **1** | Phase 1: GridDefinition | ì›ë³¸ ì •ì˜ ë¶„ë¦¬ â†’ ëª¨ë“  ë²„ê·¸ì˜ ê·¼ë³¸ í•´ê²° | 2-3ì¼ |
| **2** | Phase 3: Preview & Apply | ì‚¬ìš©ì ê²½í—˜ ê°œì„  â†’ ì•ˆì „í•œ ì„¤ì • ë³€ê²½ | 2-3ì¼ |
| **3** | Phase 2: Definition Editor | ì½”ë“œ ì—†ì´ Grid ì •ì˜ â†’ ì™„ì „í•œ No-Code | 3-5ì¼ |

> Phase 1ì´ ê°€ì¥ ì¤‘ìš”. ì›ë³¸ ì •ì˜ê°€ ìˆì–´ì•¼ Phase 3ì˜ Diffì™€ Resetì´ ê°€ëŠ¥í•˜ê³ ,
> Phase 2ì˜ Definition Editorë„ ì˜ë¯¸ê°€ ìˆìŒ.

---

## ê¸°ì¡´ ì½”ë“œ ì˜í–¥ ë¶„ì„

### í˜¸í™˜ì„± ìœ ì§€ í•„ìˆ˜

```elixir
# ê¸°ì¡´ API ìœ ì§€ (breaking change ì—†ìŒ)
Grid.new(data: users, columns: columns, options: opts)

# ìƒˆ API ì¶”ê°€
Grid.new(definition: grid_def)
Grid.from_definition(grid_def, data: users)
```

### ìˆ˜ì • ëŒ€ìƒ íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `grid.ex` | `definition` í•„ë“œ ì¶”ê°€, `apply_config_changes` ì›ë³¸ ì°¸ì¡° ë³€ê²½ |
| `config_modal.ex` | `init_column_state`ì—ì„œ `definition.columns` ì°¸ì¡° |
| `grid_component.ex` | Definition Editor ë²„íŠ¼ ì¶”ê°€ (Phase 2) |
| `demo_live.ex` | definition ê¸°ë°˜ ê·¸ë¦¬ë“œ ìƒì„± ì˜ˆì œ |
| `grid_test.exs` | definition ê´€ë ¨ í…ŒìŠ¤íŠ¸ ì¶”ê°€ |

### ì‚­ì œ ëŒ€ìƒ (Phase 1 ì™„ë£Œ ì‹œ)

- `grid.state[:all_columns]` ìš°íšŒ ì½”ë“œ â†’ `definition.columns` ì‚¬ìš©ìœ¼ë¡œ ëŒ€ì²´
- `grid.state[:hidden_columns]` â†’ `grid.runtime_config.hidden_columns`ë¡œ ì´ë™

---

## ê²€ì¦ ì‹œë‚˜ë¦¬ì˜¤

### E2E íë¦„

```
1. Grid Definition ìƒì„± (ì½”ë“œ ë˜ëŠ” UI)
   â†’ columns: [id, name, email, age, active, city]
   â†’ data_source: {:inmemory, sample_data}

2. Grid ë Œë”ë§
   â†’ 6ê°œ ì»¬ëŸ¼ ëª¨ë‘ í‘œì‹œ

3. Config Modalì—ì„œ id, email ìˆ¨ê¸°ê¸° + Apply
   â†’ 4ê°œ ì»¬ëŸ¼ë§Œ í‘œì‹œ (name, age, active, city)

4. Config Modal ì¬ì˜¤í”ˆ
   â†’ 6ê°œ ì»¬ëŸ¼ ëª©ë¡ (definitionì—ì„œ ë¡œë“œ)
   â†’ id, emailì€ unchecked ìƒíƒœ

5. id ë‹¤ì‹œ ì²´í¬ + Apply
   â†’ 5ê°œ ì»¬ëŸ¼ í‘œì‹œ (id, name, age, active, city)

6. Reset í´ë¦­
   â†’ Definition ì›ë³¸ìœ¼ë¡œ ë³µì› (6ê°œ ì»¬ëŸ¼ ì „ì²´)
```

---

## ì°¸ì¡° ë¬¸ì„œ

- ê¸°ì¡´ Plan: `docs/01-plan/features/grid-config.plan.md`
- ê¸°ì¡´ Design: `docs/02-design/features/grid-config.design.md`
- Grid í•µì‹¬ ëª¨ë“ˆ: `lib/liveview_grid/grid.ex`
- Config Modal: `lib/liveview_grid_web/components/grid_config/config_modal.ex`
